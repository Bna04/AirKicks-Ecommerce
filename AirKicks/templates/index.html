{% extends "base.html" %}
{# This page uses my main base.html layout, so I get the header and footer from there. #}

{% block title %}Browse Kicks - AirKicks{% endblock %}
{# Setting a specific title for the browser tab for this page, makes it look more professional. #}

{% block content %}
<section class="sorting_options">
    <h2>
        {% if search_query %}
            Search Results for: "{{ search_query }}"
        {% else %}
            Browse Our Premium Selection üèÄ
        {% endif %}
    </h2>
    {# This heading changes and shows "Search Results" if the user searched for something, 
       otherwise it shows my general "Browse Our Premium Selection" title. #}

    {% if not search_query %}
    {# I decided to only show these sort buttons if the user is just Browse the main page,
       not when they're looking at search results. Seemed cleaner that way. #}
    <div class="sort_buttons">
        <a href="{{ url_for('home', sort='name') }}" class="sort-btn {% if current_sort == 'name' %}active{% endif %}">üî§ A-Z</a>
        <a href="{{ url_for('home', sort='price') }}" class="sort-btn {% if current_sort == 'price' %}active{% endif %}">üí∑ Price</a>
        <a href="{{ url_for('home', sort='carbon') }}" class="sort-btn {% if current_sort == 'carbon' %}active{% endif %}">üå± Eco Rating</a>
    </div>
    {# These are the links for sorting the products. I made the 'active' class highlight
       which sorting option is currently being used, which I think is a nice touch for the user. #}
    {% endif %}
</section>
{# This whole 'section' at the top is for the page title and the sorting buttons. #}

<div class="product-grid">
    {% if not products %}
        <p class="text-center" style="grid-column: 1 / -1;">No products found matching your criteria.</p>
        {# If my app.py doesn't find any products (like from a search that has no matches), 
           I show this message instead of just an empty space. The style makes it span the whole grid width. #}
    {% endif %}

    {% for product in products %}
    {# This is the main loop where I go through each 'product' that app.py sent to this page. #}
    <article class="sneaker-card" data-product-id="{{ product.id }}">
        {# Each product gets its own 'sneaker-card'. The data-product-id is for my JavaScript, like for the hover effect. #}
        <a href="{{ url_for('product_details', product_id=product.id) }}" class="product-link">
            {# I made the whole main part of the card a link to that product's own detail page. #}
            <div class="product-image-container">
                <img src="{{ url_for('static', filename='images/' + product.image) if product.image else url_for('static', filename='images/default-sneaker.png') }}" alt="{{ product.name }}" class="product-image">
                {# Showing the product image here. I used my usual fallback to 'default-sneaker.png' if a specific image isn't set for a product. #}
            </div>
            <div class="sneaker-info">
                <h3 class="product-title">
                    {{ product.name }}
                </h3>
                {# This is for the product's name. #}
                <div class="price-eco-container">
                    <div class="price-tag">
                        ¬£{{ "%.2f"|format(product.price) }}
                    </div>
                    {# Displaying the price, formatted to two decimal places. #}
                    <div class="eco-rating">
                        <span>
                            üå±
                        </span>
                        <span>
                            {{ product.carbon_footprint }}kg CO‚ÇÇ
                        </span>
                        {# And the eco rating info. #}
                    </div>
                </div>
                {# This div groups the price and eco rating together for styling. #}
            </div>
            {# This div holds the text info for the product card. #}
        </a>
        <button class="add-to-cart" data-product-id="{{ product.id }}"> 
            üõí Add
        </button>
        {# The 'Add to Cart' button for each product. Again, data-product-id is for my JavaScript. #}
    </article>
    {# This 'article' tag represents one complete product card in the grid. #}
    {% endfor %}
    {# This ends the loop that displays all the product cards. #}
</div>
{# This main 'div' with class 'product-grid' is where all the sneaker cards are displayed. My CSS handles making it a grid. #}

<div id="product-tooltip" class="product-tooltip" style="display:none;">
    
</div>
{# This empty div is important for the AJAX hover feature. My JavaScript finds this div by its ID and puts the product details into it when a user hovers over a card. 
   I set display:none here because the JS will control when it's visible. #}
{% endblock %}
{# This ends the main content block for the homepage. #}